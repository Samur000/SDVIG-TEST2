# СДВиГ — Productivity PWA для людей с СДВГ

## Описание проекта

СДВиГ — это Progressive Web Application (PWA) для управления задачами, привычками, финансами и расписанием. Приложение разработано с учётом особенностей людей с синдромом дефицита внимания и гиперактивности (СДВГ), но подходит для любого пользователя, которому нужен простой и понятный инструмент для организации повседневной жизни.

Приложение полностью работает офлайн после первой загрузки, не требует регистрации и хранит все данные локально в браузере пользователя.

## Основной функционал

### День (Расписание)

Главный экран приложения, ориентированный на текущий день.

**Данные:**
- Рутины — повторяющиеся ежедневные/еженедельные активности с указанием времени и дней недели
- События — одноразовые дела с привязкой к конкретной дате
- 3 главные задачи дня — фокусировка на самом важном

**Возможности:**
- Навигация по неделям (свайп или стрелки)
- Выбор даты через календарь
- Отметка выполнения рутин и событий
- Перенос события на завтра
- Фокус-режим с таймером (15/25/45 минут) для концентрации на задаче
- Учёт времени в фокус-режиме

### Дела (To-Do и Привычки)

Раздел управления задачами и привычками.

**To-Do:**
- Задачи с датой выполнения (сегодня, на этой неделе, когда-нибудь)
- Приоритеты: обычный и важный
- Оценка времени: 5, 15, 30 или 60 минут
- Подзадачи через функцию «Я застрял» (декомпозиция)
- Архив выполненных задач
- Фиксация времени создания и выполнения

**Привычки:**
- Частота: ежедневно, по будням, конкретные дни недели, X раз в неделю
- Минимальный объём (например, «10 минут», «5 страниц»)
- Статистика: стрик (дней подряд) и процент выполнения за неделю

### Финансы

Учёт доходов и расходов.

**Данные:**
- Кошельки: наличные и карты (баланс для каждого)
- Транзакции: тип (доход/расход), сумма, категория, комментарий, дата

**Возможности:**
- Общий баланс и разбивка по типам кошельков
- Аналитика: расходы за неделю и месяц
- Топ-3 категории расходов за месяц
- История операций с группировкой по датам
- Сортировка транзакций от новых к старым

### Инбокс (Мысли)

Быстрый сбор идей и мыслей.

**Возможности:**
- Быстрое добавление мыслей через текстовое поле
- Преобразование мысли в задачу (To-Do)
- Преобразование мысли в событие (расписание)
- Удаление обработанных мыслей

### Профиль (Я)

Личная информация и сводка.

**Данные:**
- Имя, описание (bio), аватар
- До 3 целей

**Возможности:**
- Сводка по деньгам (общий баланс)
- Статистика за неделю: задачи, привычки, фокус-время
- Хранение документов (фото/изображения)
- Поделиться или скачать документ

### Настройки

Отдельная страница с настройками приложения.

**Возможности:**
- Редактирование личных данных (имя, bio, цели, аватар)
- Переключение темы: светлая / тёмная
- Экспорт данных в JSON-файл (бэкап)
- Импорт данных из JSON-файла
- Ссылки на информацию о проекте и контакт разработчика

## Технологический стек

| Технология | Версия | Назначение |
|------------|--------|------------|
| React | 18.2.0 | UI-фреймворк |
| TypeScript | 5.2.2 | Типизация |
| Vite | 5.0.0 | Сборка и dev-сервер |
| React Router DOM | 6.20.0 | Маршрутизация (SPA) |
| vite-plugin-pwa | 0.17.4 | PWA-функциональность |
| uuid | 9.0.1 | Генерация уникальных ID |

## Хранение данных

### IndexedDB (основное хранилище)

С версии 2.0 все данные приложения хранятся в IndexedDB.

**Структура базы данных:**
- База данных: `sdvig-db`
- Object Store: `appState`
- Ключ: `main` — единственная запись с полным состоянием приложения

**Сохраняемые сущности:**
- `routines` — рутины
- `events` — события
- `dayTasks` — задачи дня (по датам)
- `wallets` — кошельки
- `transactions` — финансовые операции
- `categories` — категории расходов/доходов
- `tasks` — задачи To-Do
- `habits` — привычки
- `ideas` — мысли/идеи
- `profile` — профиль пользователя
- `documents` — документы (изображения в base64)
- `focusSessions` — сессии фокус-режима
- `settings` — настройки (тема)

### Миграция данных

При первом запуске версии 2.0 выполняется автоматическая миграция:

1. Проверяется флаг `data_migrated_to_indexeddb` в localStorage
2. Если флага нет — данные из `sdvig-app-state` (localStorage) переносятся в IndexedDB
3. После успешной миграции устанавливается флаг
4. Старые данные в localStorage сохраняются как резерв

Миграция безопасна: при ошибке флаг не устанавливается, приложение продолжает работать.

### Fallback на localStorage

Если IndexedDB недоступен (старые браузеры, режим инкогнито в некоторых браузерах), приложение автоматически использует localStorage.

## PWA-поведение и офлайн-работа

### Service Worker

Настроен через `vite-plugin-pwa` с режимом `autoUpdate`:
- Автоматическое обновление при наличии новой версии
- Кеширование всех статических ресурсов (JS, CSS, HTML, изображения, шрифты)
- Runtime-кеширование Google Fonts (стратегия CacheFirst)

### Manifest

```
name: СДВиГ - Productivity для СДВГ
short_name: СДВиГ
display: standalone
orientation: portrait
theme_color: #0F766E
background_color: #FFFFFF
```

### Установка на устройство

PWA можно установить на главный экран:
- **Android**: через меню браузера «Добавить на главный экран»
- **iOS**: Safari → «Поделиться» → «На экран Домой»
- **Desktop**: Chrome/Edge показывают кнопку установки в адресной строке

### Кешируемые ресурсы

- Все файлы: `**/*.{js,css,html,ico,png,woff2}`
- Максимальный размер файла для кеширования: 5 МБ
- Google Fonts кешируются на 1 год

### Ограничения PWA

- Нет push-уведомлений
- Нет фоновой синхронизации
- Данные хранятся только локально (без облачного бэкапа)

## Установка и запуск для разработки

### Требования

- Node.js версии 18+ (рекомендуется 20 LTS)
- npm (поставляется с Node.js)

### Установка

```bash
# Клонирование репозитория
git clone https://github.com/Samur000/SDVIG.git
cd SDVIG

# Установка зависимостей
npm install
```

### Запуск dev-сервера

```bash
npm run dev
```

Dev-сервер запустится на `http://localhost:3000`.

### Production-сборка

```bash
# Компиляция TypeScript + сборка Vite
npm run build

# Предпросмотр production-сборки
npm run preview
```

## Сборка и деплой

### Процесс сборки

1. TypeScript компилируется в JavaScript (`tsc`)
2. Vite собирает бандл в папку `dist/`
3. vite-plugin-pwa генерирует service worker и manifest

### Результат сборки

В папке `dist/` формируется статический сайт:
- `index.html` — точка входа
- `assets/` — JS, CSS, шрифты
- `sw.js` — service worker
- `manifest.webmanifest` — PWA-манифест
- Иконки и favicon

### GitHub Pages (автоматический деплой)

Репозиторий настроен на автоматический деплой через GitHub Actions:

1. При push в `main` запускается workflow `.github/workflows/deploy.yml`
2. Workflow устанавливает Node.js 20, собирает проект
3. Результат публикуется в ветку `gh-pages`
4. GitHub Pages раздаёт содержимое `gh-pages`

**Важно:** в `vite.config.ts` указан `base: '/SDVIG/'` для корректной работы на GitHub Pages.

### Деплой на другие хостинги

Для статического хостинга (Vercel, Netlify, Firebase Hosting и др.):

1. Измените `base` в `vite.config.ts` на `/` или нужный путь
2. Запустите `npm run build`
3. Загрузите содержимое папки `dist/` на хостинг

## Структура проекта

```
src/
├── main.tsx              # Точка входа React
├── App.tsx               # Корневой компонент, роутинг
├── index.css             # Глобальные стили, CSS-переменные
├── vite-env.d.ts         # Типы Vite
│
├── components/           # Переиспользуемые UI-компоненты
│   ├── Layout/           # Общий layout страниц (шапка, навигация)
│   ├── Modal/            # Модальные окна
│   └── UI/               # Базовые элементы (Checkbox, EmptyState, Toast)
│
├── pages/                # Страницы приложения
│   ├── Day/              # Расписание дня (рутины, события, календарь, фокус)
│   ├── Finance/          # Финансы
│   ├── Tasks/            # Дела (To-Do и привычки)
│   ├── Inbox/            # Инбокс (мысли)
│   └── Profile/          # Профиль и настройки
│
├── store/                # Управление состоянием
│   ├── AppContext.tsx    # React Context + useReducer
│   ├── storage.ts        # Абстракция над хранилищем
│   └── indexedDB.ts      # Работа с IndexedDB
│
├── types/                # TypeScript типы
│   └── index.ts          # Все интерфейсы и типы приложения
│
└── utils/                # Утилиты
    ├── date.ts           # Работа с датами
    └── feedback.ts       # Вибрация, мотивационные сообщения
```

## Настройка и кастомизация

### Цвета и темы

CSS-переменные определены в `src/index.css`:

```css
:root {
  --bg: #FFFFFF;
  --bg-secondary: #F5F5F5;
  --text: #1F2937;
  --text-secondary: #6B7280;
  --accent: #0F766E;
  --accent-soft: #D1FAE5;
  --border: #E5E7EB;
  /* ... */
}

[data-theme="dark"] {
  --bg: #1A1A1A;
  /* ... */
}
```

### Категории расходов

Дефолтные категории определены в `src/types/index.ts`:

```typescript
export const defaultCategories = [
  'Еда', 'Транспорт', 'Развлечения', 'Здоровье',
  'Одежда', 'Подписки', 'Зарплата', 'Подарки', 'Другое'
];
```

### Кошельки по умолчанию

```typescript
wallets: [
  { id: 'wallet-cash', type: 'cash', name: 'Наличные', balance: 0 },
  { id: 'wallet-card', type: 'card', name: 'Карта', balance: 0 }
]
```

### Конфигурация PWA

Настройки PWA в `vite.config.ts`:
- Иконки, цвета, название
- Параметры кеширования
- Service worker

### Локализация

Все тексты на русском языке захардкожены в компонентах. Для локализации потребуется:
1. Вынести строки в отдельные файлы
2. Добавить библиотеку i18n (react-intl, react-i18next и т.п.)

## Известные ограничения

- **Браузерная совместимость**: требуется поддержка IndexedDB. В режиме инкогнито некоторые браузеры ограничивают хранилище.
- **Отсутствие авторизации**: данные хранятся локально, нет синхронизации между устройствами.
- **Отсутствие облачного бэкапа**: пользователь сам отвечает за экспорт/импорт данных.
- **Локальный часовой пояс**: все даты работают в локальном времени браузера.
- **Размер документов**: изображения документов хранятся в base64, большие файлы увеличивают размер базы данных.
- **Нет напоминаний**: приложение не отправляет уведомления о задачах и событиях.

## Лицензия

В репозитории отсутствует файл лицензии. Автору проекта рекомендуется выбрать и добавить подходящую лицензию (MIT, Apache 2.0, GPL и др.) для определения условий использования и распространения кода.

---

**Версия**: 2.0  
**Автор**: [@qafurov](https://t.me/qafurov)  
**Репозиторий**: [github.com/Samur000/SDVIG](https://github.com/Samur000/SDVIG)

